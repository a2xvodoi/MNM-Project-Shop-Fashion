<%- include('../layouts/head',{title: 'Quản lý sản phẩm'}) %>
<!-- Main content -->
<section class="content">
	<div class="container-fluid">
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-header">
						<div class="d-flex align-items-center">
							<h3 class="card-title">Sản phẩm</h3>
							<a href="/admin/products/create">
								<div class="btn btn-success ml-3">Thêm mới</div>
							</a>
						</div>
						<div class="card-tools">
							<div class="input-group input-group-sm" style="width: 150px;">
								<input type="text" name="table_search" class="form-control float-right"
									placeholder="Search">

								<div class="input-group-append">
									<button type="submit" class="btn btn-default">
										<i class="fas fa-search"></i>
									</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /.card-header -->
					<div class="card-body table-responsive p-0">
						<table class="table table-head-fixed table-striped">
							<thead>
								<tr>
									<th>ID</th>
									<th>Product Name</th>
									<th>Avatar</th>
									<th>Category</th>
									<th>Price</th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<% products.forEach(product => { %>
								<tr>
									<td>
										<%= product._id %>
									</td>
									<td>
										<%= product.name %>
									</td>
									<td>
										<img src="<%= product.avatar %> " alt="" width="100px" height="100px">
									</td>
									<td>
										<%= product.category.name %>
									</td>
									<td>
										<%= product.price %>
									</td>
									<td class="text-right">
										<a class="btn btn-primary btn-sm" href="/admin/products/<%= product._id %>">
											<i class="fas fa-folder">
											</i>
											View
										</a>
										<a class="btn btn-info btn-sm" href="/admin/products/<%= product._id %>/edit">
											<i class="fas fa-pencil-alt">
											</i>
											Edit
										</a>
										<a class="btn btn-danger btn-sm" href="#" data-toggle="modal"
											data-target="#deleteModal" data-_id="<%= product._id %>"
											data-type="products">
											<i class="fas fa-trash">
											</i>
											Delete 
										</a>
									</td>
								</tr>
								<% }) %>
							</tbody>
						</table>
					</div>
					<div class="m-3">
						<!-- pagination -->
						<% if(pages > 0) { %> <!-- show pagination if there is pages -->
						  <nav class="mx-auto">
							<ul class="pagination">
							  <!-- FIRST ITEM -->
							  <% if(current == 1) { %>
								<li class="page-item disabled">
								  <a class="page-link" href="#">First</a>
								</li>
							  <% } else { %>
								<li class="page-item">
								  <a class="page-link" href="?page=1">First</a>
								</li>
							  <% } %>
							  <!-- ITEMS  -->
							  <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
							  <% if(i !== 1) { %>
								<li class="page-item disabled">
								  <a class="page-link" href="#">...</a>
								</li>
							  <% } %>
							  <% for(; i <= (Number(current) + 4) && i <= pages; i++) { %>
								<% if(i == current) { %>
								  <li class="page-item active">
									<a class="page-link" href="?page=<%= i %>">
									  <%= i %>
									</a>
								  </li>
								<% } else { %>
								  <li class="page-item">
									<a class="page-link" href="?page=<%= i %>">
									  <%= i %>
									</a>
								  </li>
								<% } %>
								<% if (i == Number(current) + 4 && i < pages) { %>
								   <li class="page-item disabled">
									 <a class="page-link" href="#">...</a>
								   </li>
								<% } %>
							  <% } %>
							  <!-- LAST ITEM -->
							  <% if(current == pages) { %>
								<li class="page-item disabled">
								  <a class="page-link" href="#">
									Last
								  </a>
								</li>
							  <% } else { %>
								<li class="page-item">
								  <a class="page-link" href="?page=<%= pages %>">
									Last
								  </a>
								</li>
							  <% } %>
							</ul>
						  </nav>
						<% } %>
					
					</div>
					<!-- /.card-body -->
				</div>
				<!-- /.card -->
			</div>
		</div>
	</div><!-- /.container-fluid -->
</section>
<!-- /.content -->

<!-- Footer Start -->
<%- include('../partials/footer') %>
<!-- Footer Bottom End -->
<%- include('../partials/delete-modal') %>
<% if (message && message.type === 'create' && message.status === 'success') { %>
<script>
	Swal.fire(
		'Success!',
		'Thêm sản phẩm thành công!',
		'success'
	)
</script>
<% } %>
<% if (message && message.type === 'update' && message.status === 'success') { %>
<script>
	Swal.fire(
		'Success!',
		'Cập nhật sản phẩm thành công!',
		'success'
	)
</script>
<% } %>
<% if (message && message.type === 'delete' && message.status === 'success') { %>
<script>
	Swal.fire(
		'Success!',
		'Xoá sản phẩm thành công!',
		'success'
	)
</script>
<% } %>
<% if (message && message.type === 'delete' && message.status === 'error') { %>
<script>
	Swal.fire(
		'Error!',
		'Xoá sản phẩm thất bại!',
		'error'
	)
</script>
<% } %>
<%- include('../layouts/foot')%>